<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.choerodon.agile.infra.mapper.TagIssueRelMapper">

    <select id="selectByTagIdsAndIssueType" resultType="java.lang.Long">
        select atir.issue_id
        from agile_tag_issue_rel atir
        join agile_issue ai on atir.issue_id = ai.issue_id
        where atir.organization_id = #{organizationId}
        and atir.project_id = #{projectId}
        and atir.tag_id in
        <foreach collection="tagIds" item="tagId" open="(" separator="," close=")">
            #{tagId}
        </foreach>
        and ai.type_code = #{issueTypeCode}
    </select>
</mapper>